<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<title>CPM (AON) Generator</title>
	<style>
		body {
			background-color: #222222;
			color: #FFFFFF;
		}

		h1 {
			text-align: left;
			 font-size: 25px;
		}
		h2 {
			text-align: center;
			 font-size: 25px;
		}
		.title {
			font-size: 36px;
			font-weight: bold;
			text-align: center;
		}
		.created-by {
			font-style: italic;
			font-size: 14px;
			text-align: right;
		}
        nav ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #333;
            display: flex; /* use flexbox to display the tabs side by side */
        }

        nav li {
            float: none;
            display: inline-block; /* use inline-block to display the tabs side by side */
        }

        nav li a {
            display: block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

            nav li a:hover {
            background-color: #111;
        }
            nav li.active {
            background-color: black;
        }

	</style>	
</head>
<body>
</head>
	<div class="title">CPM (AON) GENERATOR</div>
    <div class="created-by">Created by FU</div>	
    
    <nav>
        <ul>
            <li><a href="/">Activity Network Diagram</a></li>
            <li class="active"><a href="/newtab">Criticality Index &amp; S-curve</a></li>
        </ul>
    </nav>
    <h1></h1>
    <form method="POST" action="/newtab">
        <table id="activity-table">
            <tr>
                <th>Activity Name</th>
                <th>Most Likely Dur.</th>
                <th>Successors (comma separated)</th>
                <th>Best Case Dur.</th>
                <th>Worst Case Dur.</th>
                <th>Dist. Type</th>
                <th></th>
                <th>Num. of simulations</th>
                <!-- START GENERATED SIMNUM CODE --><td><input type="number" name="num" min="0" value="100"></td><!-- END GENERATED SIMNUM CODE -->
                <th>Dist. Type All:</th> 
                <!-- START GENERATED CHECK CODE -->
                <td><input type="checkbox" name="agree" value="yes" id="agree-checkbox">
                    <select id="distribution" name="distribution" disabled><!-- END GENERATED CHECK CODE -->                
                    
                        <!-- START GENERATED DROPDOWN CODE -->                           
            <option value="triangular" selected>Triangular</option>
            <option value="normal">Normal</option>
            <option value="uniform">Uniform</option><!-- END GENERATED DROPDOWN CODE -->
                    </select>
                </td>
            </tr>
                
            <!-- START GENERATED HTML CODE -->
            <tr>
                <td><input type="text" name="activity" value="A"></td>
                <td><input type="number" name="duration" min="0" value="3"></td>
                <td><input type="text" name="successor" value="B,C"></td>
                <td><input type="number" name="stddev" min="0" value="1"></td>
                <td><input type="number" name="worst" min="0" value="10"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="B"></td>
                <td><input type="number" name="duration" min="0" value="4"></td>
                <td><input type="text" name="successor" value="D"></td>
                <td><input type="number" name="stddev" min="0" value="1"></td>
                <td><input type="number" name="worst" min="0" value="10"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="normal" selected>normal</option>
            <option value="triangular">triangular</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="C"></td>
                <td><input type="number" name="duration" min="0" value="8"></td>
                <td><input type="text" name="successor" value="F,E"></td>
                <td><input type="number" name="stddev" min="0" value="5"></td>
                <td><input type="number" name="worst" min="0" value="50"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="normal" selected>normal</option>
            <option value="triangular">triangular</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="D"></td>
                <td><input type="number" name="duration" min="0" value="5"></td>
                <td><input type="text" name="successor" value="G"></td>
                <td><input type="number" name="stddev" min="0" value="1"></td>
                <td><input type="number" name="worst" min="0" value="10"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="E"></td>
                <td><input type="number" name="duration" min="0" value="7"></td>
                <td><input type="text" name="successor" value="G"></td>
                <td><input type="number" name="stddev" min="0" value="5"></td>
                <td><input type="number" name="worst" min="0" value="50"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="F"></td>
                <td><input type="number" name="duration" min="0" value="8"></td>
                <td><input type="text" name="successor" value="H"></td>
                <td><input type="number" name="stddev" min="0" value="6"></td>
                <td><input type="number" name="worst" min="0" value="60"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="G"></td>
                <td><input type="number" name="duration" min="0" value="4"></td>
                <td><input type="text" name="successor" value="H"></td>
                <td><input type="number" name="stddev" min="0" value="1"></td>
                <td><input type="number" name="worst" min="0" value="10"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        
            <tr>
                <td><input type="text" name="activity" value="H"></td>
                <td><input type="number" name="duration" min="0" value="6"></td>
                <td><input type="text" name="successor" value=""></td>
                <td><input type="number" name="stddev" min="0" value="1"></td>
                <td><input type="number" name="worst" min="0" value="10"></td>
                <td>                
                    <select id="distribution_single" name="distribution_single">                         
            <option value="triangular" selected>triangular</option>
            <option value="normal">normal</option>
            <option value="uniform">uniform</option>
                    </select>
                </td>
                <td><button type="button" class="remove-row">Remove</button></td>
                
            </tr>
        <!-- END GENERATED HTML CODE -->
        </table>
        <button type="button" id="add-row">Add Row</button>
        <br><br>
        <input type="submit" value="Update inputs">

        <img class="image" src="{{ url_for('static', filename='c1.png') }}" alt="Graph" style="position: absolute; top: 4700px; left: 40px;">
        <img class="image" src="{{ url_for('static', filename='c2.png') }}" alt="Graph" style="position: absolute; top: 4700px; left: 700px;">
        <img class="image" src="{{ url_for('static', filename='notes_for_excel_2.png') }}" alt="Graph" style="position: absolute; top: 380px; left: 550px;">
		
    </form>
    <script>
        $(document).ready(function() {
            // Add row
            $('#add-row').click(function() {
                var $row = $('<tr>' +
                                '<td><input type="text" name="activity"></td>' +
                                '<td><input type="number" name="duration" min="0"></td>' +
                                '<td><input type="text" name="successor"></td>' +
                                '<td><input type="number" name="stddev"></td>' +
                                '<td><input type="number" name="worst"></td>' +
                                '<td>' +
                                '<select id="distribution_single" name="distribution_single">' +
                                    '<option value="triangular" selected>triangular</option>' +
                                    '<option value="normal">normal</option>' +
                                    '<option value="uniform">uniform</option>' +
                                '</select>' +
                            '</td>' +
                                '<td><button type="button" class="remove-row">Remove</button></td>' +
                            '</tr>');
                $('#activity-table').append($row); // Append at end of table
            });

            // Remove row
            $(document).on('click', '.remove-row', function() {
                $(this).closest('tr').remove();
            });

            // Handle checkbox click event
            $('input[type="checkbox"]').on('click', function() {
                var select = $('select[name="distribution"]');
                if ($(this).is(':checked')) {
                    select.prop('disabled', false);
                } else {
                    select.prop('disabled', true);
                }
            });

            // Handle checkbox click event for second table
            $('input[type="checkbox"]').on('click', function() {
                var select = $('select[name="distribution_single"]');
                if ($(this).is(':checked')) {
                    select.prop('disabled', true);
                } else {
                    select.prop('disabled', false);
                }
            });
        });
    </script>

</body>
</html>

<!doctype html>
<html>
  <head>
    <title>Excel file upload example</title>
  </head>
  <body>
    <h1>Upload an Excel file</h1>
    {% if message %}
    <p>{{ message }}</p>
    {% endif %}
    <form method="POST" enctype="multipart/form-data">
      <input type="file" name="file">
      <input type="submit" value="Submit">
    </form>
  </body>

</html>
